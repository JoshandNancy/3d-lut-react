(this["webpackJsonp3d-lut-react"]=this["webpackJsonp3d-lut-react"]||[]).push([[0],{28:function(e,t,n){e.exports=n(54)},37:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(5),o=n.n(l),c=n(27),u=n(6),i=n(26),s=n(17),d=n(10),m=(n(37),[{id:1,name:"color chart",url:"https://i.imgur.com/BlUVaOM.jpg"},{id:2,name:"day2",url:"http://drive.google.com/uc?export=view&id=1CQAQAb9fW9DaZtt8AWqLmg4XhlTiLV8B"},{id:3,name:"day3",url:"http://drive.google.com/uc?export=view&id=11vhz8udKE0VXkufLK9o1NjMIKPrLtkpb"}]),g=[{id:1,name:"joyful1",url:"https://drive.google.com/uc?export=view&id=1Iw1gRnInNBNc-qsWIefZFPQ2DWepVWZV"},{id:2,name:"joyful2",url:"https://drive.google.com/uc?export=view&id=1vUSyMblGqxjMALYXVNJjddAJGfWqIs0f"},{id:3,name:"joyful3",url:"https://drive.google.com/uc?export=view&id=1-nyJ_PBgsnkx5l4Mj8XXraQE8l0PLl0C"},{id:4,name:"anime",url:"https://i.imgur.com/yKpfItb.jpg"}],f=n(18),p=function(){try{var e=localStorage.getItem("state");return console.log("firstload: ",e),null===e?{src:"https://i.imgur.com/BlUVaOM.jpg",srcname:"Sample",lut:"https://i.imgur.com/yKpfItb.jpg",lutname:"testLUT"}:JSON.parse(e)}catch(t){return}}(),h=Object(f.b)({name:"imgManager",initialState:p,reducers:{selectSrc:function(e,t){return{src:t.payload.value,srcname:t.payload.label,lut:e.lut,lutname:e.lutname}},selectLut:function(e,t){return{src:e.src,srcname:e.srcname,lut:t.payload.value,lutname:t.payload.label}}}}),v=h.actions,b=v.selectSrc,E=v.selectLut,y=Object(f.a)({reducer:h.reducer}),C=n(23),w=n.n(C);function L(e){var t={};return t.value=e.url,t.label=e.name,t}var j=m.map((function(e){return L(e)})),x=g.map((function(e){return L(e)}));var O=Object(d.b)((function(e){return{imgManagerSt:e}}),(function(e,t){return{SrcReducer:function(n){return e(b(n,t))},LutReducer:function(n){return e(E(n,t))}}}))((function(e){var t=e.imgManagerSt,n=e.SrcReducer,l=e.LutReducer,o=Object(a.useRef)(),c=Object(a.useRef)(),u=Object(a.useRef)(),d=Object(a.useRef)(),m=Object(a.useRef)(),g=Object(a.useRef)(),f=Object(a.useRef)(),p=Object(a.useRef)(),h=Object(a.useRef)(),v=Object(a.useRef)(),b=Object(a.useRef)(),E=Object(a.useState)(70),y=Object(i.a)(E,2),C=y[0],L=y[1];console.log("imgManagerSt: ",t),console.log("imgManagerSt.src: ",t.src),console.log("imgManagerSt.lut: ",t.lut);var O="default",R=document.createElement("img"),T=document.createElement("img"),S=null,U=null,I=null,D=null,M=null,k=null,N=null,A=null,P=null,V=null,B=null,F=null,J=null,W=null,K=null,X=null;function Z(e){e.stopPropagation(),e.preventDefault()}function q(e){e.stopPropagation(),e.preventDefault()}function G(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;console.log(t),function(e){console.log("handleFiles");var t=window.URL.createObjectURL(e[0]);console.log("filename:",e[0].name);var a=e[0].name;F.innerText=a,n({value:t,label:a})}(t)}function Q(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;console.log(t),function(e){var t=window.URL.createObjectURL(e[0]);console.log("filename:",e[0].name);var n=e[0].name;W.innerText=n,O=n,l({value:t,label:n})}(t)}function z(){T.src=t.lut,T.crossOrigin="Anonymous",console.log("LUT loaded!"),T.onload=(R.onload=H,R.onerror=function(){X.innerText="Error occured loading image",X.style.backgroundColor="red"},R.src=t.src,R.crossOrigin="Anonymous",void console.log("Source loaded!")),T.onerror=function(){X.innerText="Error occured loading LUT",X.style.backgroundColor="red"}}function H(){if(M.width=N.width=R.width,M.height=N.height=R.height,P.width=T.width,P.height=T.height,0===P.width)return console.log("lut loading error"),X.innerText="LUT is not loaded! Try again!",void(X.style.backgroundColor="red");k.drawImage(R,0,0);try{S=k.getImageData(0,0,M.width,M.height)}catch(m){console.log(m),X.innerText=m,X.style.backgroundColor="red"}U=S.data,console.log(U.length/4),V.drawImage(T,0,0);try{I=V.getImageData(0,0,P.width,P.height)}catch(m){console.log(m),X.innerText=m,X.style.backgroundColor="red"}D=I.data;var e=C/100;console.log(e);for(var t=0;t<U.length;t+=4){var n=Math.floor(U[t]/4),a=Math.floor(U[t+1]/4),r=Math.floor(U[t+2]/4),l=r%8*64+n,o=4*(512*(64*Math.floor(r/8)+a)+l);U[t]=D[o]*e+U[t]*(1-e),U[t+1]=D[o+1]*e+U[t+1]*(1-e),U[t+2]=D[o+2]*e+U[t+2]*(1-e)}A.putImageData(S,0,0),console.log("processing Done!"),X.innerText="Processing Completed!",X.style.backgroundColor="grey",console.log("resized!"),M.style.width=N.style.width="50%",console.log(M.style.width);var c=new Image,u=new Image;c=Y(M),u=Y(N),c.style.width="50%",u.style.width="50%";var i=document.createTextNode(O.concat(" : ",C,"%")),s=document.createElement("button"),d=document.createElement("div");s.appendChild(i),K.appendChild(s),K.appendChild(d),K.appendChild(c),K.appendChild(u)}function Y(e){var t=new Image;return t.src=e.toDataURL("image/jpeg"),t}return Object(a.useEffect)((function(){(M=m.current)&&(k=M.getContext("2d")),(N=g.current)&&(A=N.getContext("2d")),(P=f.current)&&(V=P.getContext("2d")),(X=o.current).style.backgroundColor="#006B54",X.style.color="white",(B=p.current).addEventListener("dragenter",Z,!1),B.addEventListener("dragover",q,!1),B.addEventListener("drop",G,!1),F=v.current,(J=h.current).addEventListener("dragenter",Z,!1),J.addEventListener("dragover",q,!1),J.addEventListener("drop",Q,!1),W=b.current,K=c.current})),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"title"},"3D LUT React App"),r.a.createElement("div",{className:"selector selector--src"},r.a.createElement("label",{className:"label label--selector",htmlFor:"imgs"},"Choose a Sample"),r.a.createElement(s.a,{options:j,ref:u,onChange:function(e){console.log("event: ",e),n(e)},id:"imgs"})),r.a.createElement("div",{className:"selector selector--lut"},r.a.createElement("label",{className:"label label--selector",htmlFor:"luts"},"Choose a LUT"),r.a.createElement(s.a,{options:x,id:"luts",onChange:function(e){l(e)}})),r.a.createElement("div",{id:"dropbox",ref:p},r.a.createElement("h2",null,r.a.createElement("div",{id:"dropmsg",ref:v},"Drag and Drop Image File HERE! ",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"Image DropZone",r.a.createElement("br",null)))),r.a.createElement("div",{id:"lutbox",ref:h},r.a.createElement("h2",null,r.a.createElement("div",{id:"lutmsg",ref:b},"Drag and Drop LUT File HERE! ",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"*",r.a.createElement("br",null),"LUT DropZone",r.a.createElement("br",null)))),r.a.createElement("form",{className:"form"},r.a.createElement("label",null,"[ LUT Opacity ]"),r.a.createElement(w.a,{formatLabel:function(e){return"".concat(e," %")},minValue:0,maxValue:100,step:5,value:C,onChange:function(e){L(e)}})),r.a.createElement("div",{ref:o,id:"errMSG"},"Ready..."),r.a.createElement("button",{onClick:function(e){o.current.innerText="Processing...",o.current.style.backgroundColor="#006B54",z()}},"Apply LUT")," ",r.a.createElement("button",{onClick:function(){K.lastChild?(K.removeChild(K.lastChild),K.removeChild(K.lastChild),K.removeChild(K.lastChild),K.removeChild(K.lastChild)):(console.log("Nothing to Undo"),X.innerText="Nothing to Undo.",X.style.backgroundColor="orange")}},"Undo"),r.a.createElement("div",{ref:d,id:"canvasArea",className:"canvas fixedcanvas"},r.a.createElement("canvas",{ref:m,id:"srcCanvas"}),r.a.createElement("canvas",{ref:g,id:"resultCanvas"}),r.a.createElement("canvas",{ref:f,id:"lutCanvas"})),r.a.createElement("div",{ref:c,id:"resultArea"}))})),R=function(){return"Gallery"};var T=function(){return r.a.createElement(c.a,null,r.a.createElement(u.a,{path:"/",exact:!0,component:O}),r.a.createElement(u.a,{path:"/:id",exact:!0,component:R}))};y.subscribe((function(){!function(e){try{var t=JSON.stringify(e);console.log("saved state :",t),localStorage.setItem("state",t)}catch(n){console.log("write error :")}}(y.getState()),console.log("store updated: ",y.getState())})),o.a.render(r.a.createElement(d.a,{store:y},r.a.createElement(T,null)),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.651916a3.chunk.js.map