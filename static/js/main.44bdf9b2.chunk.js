(this["webpackJsonp3d-lut-react"]=this["webpackJsonp3d-lut-react"]||[]).push([[0],{23:function(e,t,o){e.exports=o(34)},32:function(e,t,o){},34:function(e,t,o){"use strict";o.r(t);var n=o(0),r=o.n(n),a=o(5),l=o.n(a),c=o(22),i=o(6),d=o(10),u=o(16),g=o(12),s=(o(32),[{id:1,name:"day1",url:"https://i.imgur.com/O69N3Ef.jpg"},{id:2,name:"day2",url:"http://drive.google.com/uc?export=view&id=1CQAQAb9fW9DaZtt8AWqLmg4XhlTiLV8B"},{id:3,name:"day3",url:"http://drive.google.com/uc?export=view&id=11vhz8udKE0VXkufLK9o1NjMIKPrLtkpb"}]),m=[{id:1,name:"joyful1",url:"https://drive.google.com/uc?export=view&id=1Iw1gRnInNBNc-qsWIefZFPQ2DWepVWZV"},{id:2,name:"joyful2",url:"https://drive.google.com/uc?export=view&id=1vUSyMblGqxjMALYXVNJjddAJGfWqIs0f"},{id:3,name:"joyful3",url:"https://drive.google.com/uc?export=view&id=1-nyJ_PBgsnkx5l4Mj8XXraQE8l0PLl0C"},{id:4,name:"anime",url:"https://i.imgur.com/yKpfItb.jpg"}],p=o(17),h=function(){try{var e=localStorage.getItem("state");return console.log("firstload: ",e),null===e?[]:JSON.parse(e)}catch(t){return}}(),v=Object(p.b)({name:"imgManager",initialState:h,reducers:{selectSrc:function(e,t){return{src:t.payload.value,srcname:t.payload.label,lut:e.lut,lutname:e.lutname}},selectLut:function(e,t){return{src:e.src,srcname:e.srcname,lut:t.payload.value,lutname:t.payload.label}}}}),f=v.actions,y=f.selectSrc,E=f.selectLut,w=Object(p.a)({reducer:v.reducer}),x=function(e,t){var o=Object(n.useState)(e),r=Object(d.a)(o,2),a=r[0],l=r[1];return{props:{value:a,onInput:function(e){var o=e.target.value,n=!0;"function"===typeof t&&(n=t(o)),n&&l(o)}},utils:{setValue:l}}};function C(e){var t={};return t.value=e.url,t.label=e.name,t}var b=s.map((function(e){return C(e)})),I=m.map((function(e){return C(e)}));var j=Object(g.b)((function(e){return{imgManagerSt:e}}),(function(e,t){return{selectSrcSt:function(o){return e(y(o,t))},selectLutSt:function(o){return e(E(o,t))}}}))((function(e){var t=e.imgManagerSt,o=e.selectSrcSt,a=e.selectLutSt,l=x(.7),c=Object(n.useState)({lut:"https://i.imgur.com/yKpfItb.jpg"}),i=Object(d.a)(c,2),g=i[0],s=(i[1],Object(n.useState)({src:"https://i.imgur.com/BlUVaOM.jpg"})),m=Object(d.a)(s,2),p=m[0];m[1],console.log("imgManagerSt: ",t),console.log("imgManagertype: ",typeof t);var h=document.createElement("img"),v=document.createElement("img"),f=null,y=null,E=null,w=null,C=document.createElement("canvas"),j=C.getContext("2d");document.body.appendChild(C);var L=document.createElement("canvas"),T=L.getContext("2d");document.body.appendChild(L);var U=document.createElement("canvas");U.id="lut_vas";var k=U.getContext("2d");function O(){v.src=g.lut,v.crossOrigin="Anonymous",console.log("source lut",v.src),console.log("LUT loaded!"),v.onload=(h.onload=N,h.onerror=function(){S.current.innerText="Error occured loading image",S.current.style.backgroundColor="red"},h.src=p.src,console.log("state:",p),console.log("sourceImage.src",h.src),h.crossOrigin="Anonymous",void console.log("Source loaded!")),v.onerror=function(){S.current.innerText="Error occured loading LUT",S.current.style.backgroundColor="red"}}document.body.appendChild(U);var S=Object(n.useRef)(),B=Object(n.useRef)(),M=Object(n.useRef)();function N(){if(C.width=L.width=h.width,C.height=L.height=h.height,U.width=v.width,U.height=v.height,0===U.width)return console.log("lut loading error"),S.current.innerText="LUT is not loaded! Try again!",void(S.current.style.backgroundColor="red");j.drawImage(h,0,0),f=j.getImageData(0,0,C.width,C.height),y=f.data,console.log(y.length/4),k.drawImage(v,0,0);try{E=k.getImageData(0,0,U.width,U.height)}catch(g){console.log(g),S.current.innerText=g,S.current.style.backgroundColor="red"}w=E.data,console.log(.7);for(var e=0;e<y.length;e+=4){var t=Math.floor(y[e]/4),o=Math.floor(y[e+1]/4),n=Math.floor(y[e+2]/4),r=n%8*64+t,a=4*(512*(64*Math.floor(n/8)+o)+r);y[e]=.7*w[a]+y[e]*(1-.7),y[e+1]=.7*w[a+1]+y[e+1]*(1-.7),y[e+2]=.7*w[a+2]+y[e+2]*(1-.7)}T.putImageData(f,0,0),console.log("processing Done!"),S.current.innerText="Processing Completed!",S.current.style.backgroundColor="grey";var l=new Image,c=new Image;l=R(C),c=R(L),l.style.width="50%",c.style.width="50%";var i=document.createTextNode("default".concat(" : ",.7)),d=document.createElement("button"),u=document.createElement("div");d.appendChild(i),B.current.appendChild(d),B.current.appendChild(u),B.current.appendChild(l),B.current.appendChild(c)}function R(e){var t=new Image;return t.src=e.toDataURL("image/jpeg"),t}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"title"},"3D LUT React App"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"imgs"},"Choose a Sample"),r.a.createElement(u.a,{options:b,ref:M,onChange:function(e){o(e)},name:"imgs"}),r.a.createElement("label",{htmlFor:"luts"},"Choose a LUT"),r.a.createElement(u.a,{options:I,name:"luts",onChange:function(e){a(e),console.log("imgManagerSt: ",t)}})),r.a.createElement("div",{ref:S,id:"errMSG"},"Ready..."),r.a.createElement("div",{class:"controls__range"},"Opacity :",r.a.createElement("input",{type:"range",id:"jsRange",min:"0.0",max:"1.0",value:"0.7",step:"0.1"}),r.a.createElement("input",Object.assign({placeholder:"Name"},l)),r.a.createElement("span",{id:"rangeText"},"0.7")),r.a.createElement("button",{onClick:function(e){S.current.innerText="Processing...",S.current.style.backgroundColor="#006B54",O()}},"Apply LUT"),r.a.createElement("div",{ref:B,id:"resultArea"}))})),L=function(){return"Gallery"};var T=function(){return r.a.createElement(c.a,null,r.a.createElement(i.a,{path:"/",exact:!0,component:j}),r.a.createElement(i.a,{path:"/:id",exact:!0,component:L}))};w.subscribe((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(o){console.log("write error :")}}(w.getState()),console.log("store updated: ",w.getState())})),l.a.render(r.a.createElement(g.a,{store:w},r.a.createElement(T,null)),document.getElementById("root"));var U,k,O=document.getElementById("jsResult"),S=document.getElementById("jsCanvas"),B=document.getElementById("dropmsg"),M=document.getElementById("lutmsg"),N="default";function R(e){e.stopPropagation(),e.preventDefault()}function A(e){e.stopPropagation(),e.preventDefault()}(U=document.getElementById("dropbox")).addEventListener("dragenter",R,!1),U.addEventListener("dragover",A,!1),U.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;console.log(t),function(e){console.log("handleFiles");var t=window.URL.createObjectURL(e[0]);console.log(typeof e[0].name);var o=e[0].name;B.innerText=o,ne.src=t}(t)}),!1),(k=document.getElementById("lutbox")).addEventListener("dragenter",R,!1),k.addEventListener("dragover",A,!1),k.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;console.log(t),function(e){console.log("handleLUTFiles");var t=window.URL.createObjectURL(e[0]),o=e[0].name;M.innerText=o,ne.lut=t,N=o}(t)}),!1);var P=.7,D=document.getElementById("jsRange"),V=document.getElementById("rangeText");D.addEventListener("input",(function(e){var t=e.target.value;console.log(t),P=t,V.innerText=P}));var Z={test1:"https://i.imgur.com/O69N3Ef.jpg",night1:"http://drive.google.com/uc?export=view&id=11vhz8udKE0VXkufLK9o1NjMIKPrLtkpb",day1:"http://drive.google.com/uc?export=view&id=1CQAQAb9fW9DaZtt8AWqLmg4XhlTiLV8B"},J={test1:"https://i.imgur.com/ncnPiqq.jpg",joyful1:"https://drive.google.com/uc?export=view&id=1Iw1gRnInNBNc-qsWIefZFPQ2DWepVWZV",joyful2:"https://drive.google.com/uc?export=view&id=1vUSyMblGqxjMALYXVNJjddAJGfWqIs0f",joyful3:"https://drive.google.com/uc?export=view&id=1-nyJ_PBgsnkx5l4Mj8XXraQE8l0PLl0C",joyful4:"https://drive.google.com/uc?export=view&id=1WNB3G9INvdpVuCnhy-Y_uIapC4HhQ5UC",joyful5:"https://drive.google.com/uc?export=view&id=16Ox7dNMbAUAbrKG05jWHKOsfQ7k2_PXY",metro1:"http://drive.google.com/uc?export=view&id=1B5TBN7UwixjRaEUZCT1XjHOJ0s66fGro",metro2:"http://drive.google.com/uc?export=view&id=1vQTpkfMLwm57UHZczy54l-kIyL_nwVR5",neon1:"http://drive.google.com/uc?export=view&id=1x4Fgv0JZt1crzgbjPURRkL0tMi5nCAlx",neon2:"http://drive.google.com/uc?export=view&id=1bdoV586oRkEUZA3ZFjOHNIOFJUwRFtma",neon3:"http://drive.google.com/uc?export=view&id=1fuoG6Io4pPyB1ZdlDxGHd_kR9SEZ4QPl",neon4:"http://drive.google.com/uc?export=view&id=1LkgT4kVqowcphC_ZrKoWbhjNaicbUQIT",neon5:"http://drive.google.com/uc?export=view&id=1VgTxvfdwy1UVxXEZcGvJ28oyvmpUkUK7",neon6:"http://drive.google.com/uc?export=view&id=1VgTxvfdwy1UVxXEZcGvJ28oyvmpUkUK7"},W=document.createElement("img"),X=document.createElement("img"),G=null,K=null,Q=null,q=null,F=document.createElement("canvas"),_=F.getContext("2d");S.appendChild(F);var H=document.createElement("canvas"),z=H.getContext("2d");S.appendChild(H);var Y=document.createElement("canvas");Y.id="lut_vas";var $=Y.getContext("2d");function ee(e){X.crossOrigin="Anonymous",X.src=e.lut,X.onload=function(e){W.crossOrigin="Anonymous",W.onload=oe,W.onerror=function(){te.innerText="Error occured loading image",te.style.backgroundColor="red"},W.src=e.src,console.log("Source loaded!")}(e),X.onerror=function(){te.innerText="Error occured loading LUT",te.style.backgroundColor="red"},console.log("LUT loaded!")}S.appendChild(Y);var te=document.getElementById("jsError");function oe(){if(F.width=H.width=W.width,F.height=H.height=W.height,Y.width=X.width,Y.height=X.height,0==Y.width)return console.log("lut loading error"),te.innerText="LUT is not loaded! Try again!",void(te.style.backgroundColor="red");_.drawImage(W,0,0),G=_.getImageData(0,0,F.width,F.height),K=G.data,console.log(K.length/4),$.drawImage(X,0,0);try{Q=$.getImageData(0,0,Y.width,Y.height)}catch(g){console.log(g),te.innerText=g,te.style.backgroundColor="red"}q=Q.data,console.log("Processing Start!"),console.log(P);for(var e=0;e<K.length;e+=4){var t=Math.floor(K[e]/4),o=Math.floor(K[e+1]/4),n=Math.floor(K[e+2]/4),r=n%8*64+t,a=4*(512*(64*Math.floor(n/8)+o)+r);K[e]=q[a]*P+K[e]*(1-P),K[e+1]=q[a+1]*P+K[e+1]*(1-P),K[e+2]=q[a+2]*P+K[e+2]*(1-P)}z.putImageData(G,0,0),console.log("processing Done!"),te.innerText="Processing Completed!",te.style.backgroundColor="grey",console.log("resized!"),F.style.width=H.style.width="50%",console.log(F.style.width);var l=new Image,c=new Image;l=ie(F),c=ie(H),l.style.width="50%",c.style.width="50%";var i=document.createTextNode(N.concat(" : ",P)),d=document.createElement("button"),u=document.createElement("div");d.appendChild(i),O.appendChild(d),O.appendChild(u),O.appendChild(l),O.appendChild(c)}var ne={src:Z.day1,lut:J.joyful1};var re=document.getElementById("img-select"),ae=document.getElementById("lut-select"),le=document.getElementById("lutApply"),ce=document.getElementById("lutUndo");function ie(e){var t=new Image;return t.src=e.toDataURL("image/jpeg"),t}re.addEventListener("change",(function(e){var t=e.target.value;ne.src=Z[t],console.log(ne.src)})),ae.addEventListener("change",(function(e){var t=e.target.value;ne.lut=J[t],N=t,console.log(ne.lut)})),le.addEventListener("click",(function(e){te.innerText="Processing...",te.style.backgroundColor="#006B54",ee(ne)})),ce.addEventListener("click",(function(){O.lastChild?(O.removeChild(O.lastChild),O.removeChild(O.lastChild),O.removeChild(O.lastChild),O.removeChild(O.lastChild)):console.log("Nothing to Undo")}))}},[[23,1,2]]]);
//# sourceMappingURL=main.44bdf9b2.chunk.js.map